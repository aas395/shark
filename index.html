<!DOCTYPE html>
<html>
  <head>
    <title>Dodge Sharks</title>
    <meta name="description" content="Dodge Sharks">
    <script src="https://aframe.io/releases/0.5.0/aframe.min.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-extras/v3.8.4/dist/aframe-extras.min.js"></script>
    <script src="https://cdn.rawgit.com/ngokevin/aframe-physics-components/master/dist/aframe-physics-components.min.js"></script>

    <link rel="stylesheet" href="./style.css" />

    <script>
      window.onload = function() {
        function debug(message) {
          console.log(message);

          var textEntity = document.createElement('p');
          textEntity.innerHTML = message;
          document.querySelector('#debug-console').appendChild(textEntity);
        }
        debug('test');
      }
    </script>

    <script src="game-system.js"></script>
    <script src="levels-container.js"></script>
    <script src="level.js"></script>
    <script src="obstacle.js"></script>
    <script src="tunnel.js"></script>
    <script src="listener.js"></script>
    <script src="tunnel-checkpoint.js"></script>
    <script src="button.js"></script>
  </head>
  <body>

    <div id="debug-console">
      <div>Console</div>
    </div>

    <!-- Fog for dimming objects in distance -->
    <a-scene physics="gravity: 0;" canvas fog="type: linear; color: #40a4df; far: 1000; near: 0;">
      <a-assets>
        <!-- mixins -->
        <a-mixin id="obstacle" static-body geometry="primitive: box" material="transparent: true; opacity: 0;" obstacle></a-mixin>
        <a-mixin id="tunnel" static-body geometry="primitive: cylinder; height: 6000; radius: 100; open-ended: true" position="0 0 -3000" rotation="-90 0 0" material="src: url(https://media.giphy.com/media/JXHhI4o9NCf8k/giphy.gif); shader: flat; side: double; opacity: 0.8;" tunnel></a-mixin>
        <a-mixin id="level" class="level" level></a-mixin>
        <!-- end mixins -->


        <!-- audio -->
        <!-- <audio id="river-music" src="https://cdn.glitch.com/f6776a32-7c26-4f5c-9cfd-dfedc35a5ea3%2Fshark-final.mp3?1498407744096" preload="auto" autoplay="true" loop="true"></audio> -->
        <!-- end audio -->
      </a-assets>

      <a-entity game>
        <a-entity levels-container></a-entity>

        <!-- Camera -->
        <a-entity
          id="character"
          position="0 0 0"
          kinematic-body listener="target: #character"
          camera
          universal-controls
          sound="src: #river-music"
        >

          <!--Cursor-->
          <a-entity id="cursor"
                visible="true"  
                position="0 0 -1"
                scale= ".1 .1 .1"
                geometry="primitive: ring; radiusOuter: 0.30;
                          radiusInner: 0.20;"
                material="color: cyan; shader: flat"
                cursor="fuse: true; fuse-timeout: 1200;">
          </a-entity>

          <!-- End Modal  -->
          <a-entity id="end-modal" ui-modal visible="false">
            <a-entity text="align: center; value: GAME OVER;" position="0 0.01 -.05" width="100" height="100" scale="0.1 0.1 0.1"></a-entity>
            <a-entity text="align: center; value: Restarting;" position="0 0 -.05" width="100" height="100" scale="0.05 0.05 0.05"></a-entity>
            <a-entity id="countdown" text=" align: center; value: 5;" position="0 -.01 -.05" width="100" height="100" scale="0.2 0.2 0.2"></a-entity>
            <a-plane width="100" height="100" scale="100 100 100" material="color: tomato; opacity: 0.7;" position="50 50 -0.1"></a-plane>

          </a-entity>

          <a-entity id="arms"
               scale="1.5 1.5 1.5"
               position="0 0 0"
               rotation="0 0 180"
               obj-model="obj: url(https://cdn.glitch.com/9d6d1bf1-758a-4a15-86d4-0608c7d98df9%2Farms4.obj?1498406090710); mtl: url(https://cdn.glitch.com/9d6d1bf1-758a-4a15-86d4-0608c7d98df9%2Farms4.mtl?1498408758877)">

                <a-animation attribute="rotation"
                dur="3000"
                easing="linear"
                fill="forwards"
                to="-360 0 180"
                repeat="indefinite"></a-animation>
          </a-entity>

        </a-entity>


        <!-- Intro Box -->
        <a-entity id="intro-modal" ui-modal visible="true" position="0 0 0">

          <!-- front -->
          <a-plane width="50" height="50" scale="3.5 3.5 .5" transparent="true" material="src: url(_assets/shark-teeth.png); shader:flat; transparent: true;" position="0 2 -50">
          </a-plane>

          <!-- back -->
          <a-plane id="opening-box-back" width="200" height="200" material="color: #000; shader: flat;" position="0 2 70" rotation="0 180 0">
          </a-plane>

          <!-- left -->
          <a-plane width="200" height="200" material="color: #000; shader: flat;" position="-70 2 -5" rotation="0 90 0">
          </a-plane>

          <!-- right -->
          <a-plane width="200" height="200" material="color: #000; shader: flat;" position="70 2 -5" rotation="0 -90 0">
          </a-plane>

          <!-- top -->
          <a-plane width="200" height="200" material="color: #000; shader: flat;" position="0 70 -5" rotation="90 0 0">
          </a-plane>

          <!-- bottom -->
          <a-plane width="200" height="200" material="color: #000; shader: flat;" position="0 -70 -5" rotation="-90 0 0">
          </a-plane>

          <a-text align="center" text="value: DODGE SHARKS;" position="0 0 -3" scale="1.4 1.4 1.4"></a-text>
          
          <a-entity id="start-button"
            geometry="primitive: plane; height: .55; width: 2;"
            scale="1 1 1"
            material="color: #000; opacity: 1"
            position="0 -.75 -3">
            <a-text align="center" text="value: Start;" position="0 .1 0"></a-text>
            
            <a-entity id="status-bar-container" position="0 -.1 .01" material="color: gray;" geometry="primitive: plane; height: .1; width: 1">
              <a-entity id="status-bar-progress" position="0 0 .001" material="color: cyan;" geometry="primitive: plane; height: .1; width: 0">
                <a-animation 
                  attribute="geometry.width"
                  dur="1200"
                  easing="ease-in-out"
                  fill="none"
                  from="0"
                  to="1"
                  begin="button-mouseover"
                  end="button-mouseout">
                </a-animation>
                <a-animation 
                  attribute="geometry.width"
                  dur="0"
                  to="0"
                  begin="button-mouseout">
                </a-animation>
              </a-entity>
            </a-entity>

            <!-- to prevent status bar animation from causing mouseout and canceling itself -->
            <a-entity id="start-button-mask"
              cursor-listener="target: #cursor"
              position="0 0 .1"
              material="transparent: true; opacity:0;"
              geometry="primitive: plane; height: .55; width: 2">
              </a-entity>
          </a-entity>

        </a-entity>


        <!-- End Modal  -->
        <a-entity id="end-modal" ui-modal visible="false">

          <a-plane width="50" height="50" scale="1 1 1" material="color: black;" position="0 0 0">
          </a-plane>

          <a-plane cursor-listener width="25" height="10" scale="1 1 1" material="color: black; opacity: 1" position="0 -10 -99">
          </a-plane>
        </a-entity>

        <!-- Lighting and background -->
        <a-sky color="#cccccc"></a-sky>
      </a-entity>

    </a-scene>


  </body>

</html>
